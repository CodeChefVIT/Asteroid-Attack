!function(root,factory){"function"==typeof define&&define.amd?define("p5.play",["p5"],(function(p5){factory(p5)})):"object"==typeof exports?factory(require("../p5")):factory(root.p5)}(this,(function(p5){function defineLazyP5Property(name,getter){Object.defineProperty(p5.prototype,name,{configurable:!0,enumerable:!0,get:function(){var context=this instanceof p5&&!this._isGlobal?this:window;return void 0===context._p5PlayProperties&&(context._p5PlayProperties={}),name in context._p5PlayProperties||(context._p5PlayProperties[name]=getter.call(context)),context._p5PlayProperties[name]}})}function boundConstructorFactory(constructor){if("function"!=typeof constructor)throw new Error("constructor must be a function");return function createBoundConstructor(){var pInst=this;function F(){var args=Array.prototype.slice.call(arguments);return constructor.apply(this,[pInst].concat(args))}return F.prototype=constructor.prototype,F}}function createPInstBinder(pInst){return function pInstBind(methodName){var method=pInst[methodName];if("function"!=typeof method)throw new Error('"'+methodName+'" is not a p5 method');return method.bind(pInst)}}p5.prototype.registerMethod("init",(function p5PlayInit(){this.camera=new Camera(this,0,0,1),this.camera.init=!1}));var abs=p5.prototype.abs,radians=p5.prototype.radians,dist=p5.prototype.dist,degrees=p5.prototype.degrees,pow=p5.prototype.pow,round=p5.prototype.round;defineLazyP5Property("allSprites",(function(){return new p5.prototype.Group})),p5.prototype.spriteUpdate=!0,p5.prototype.createSprite=function(x,y,width,height){var s=new Sprite(this,x,y,width,height);return s.depth=this.allSprites.maxDepth()+1,this.allSprites.add(s),s},p5.prototype.removeSprite=function(sprite){sprite.remove()},p5.prototype.updateSprites=function(upd){if(!1===upd&&(this.spriteUpdate=!1),!0===upd&&(this.spriteUpdate=!0),this.spriteUpdate)for(var i=0;i<this.allSprites.size();i++)this.allSprites.get(i).update()},p5.prototype.getSprites=function(){if(0===arguments.length)return this.allSprites.toArray();for(var arr=[],j=0;j<arguments.length;j++)for(var i=0;i<this.allSprites.size();i++)this.allSprites.get(i).isTagged(arguments[j])&&arr.push(this.allSprites.get(i));return arr},p5.prototype.drawSprites=function(group){if("function"!=typeof(group=group||this.allSprites).draw)throw"Error: with drawSprites you can only draw all sprites or a group";group.draw()},p5.prototype.drawSprite=function(sprite){sprite&&sprite.display()},p5.prototype.loadAnimation=function(){return construct(this.Animation,arguments)},p5.prototype.loadSpriteSheet=function(){return construct(this.SpriteSheet,arguments)},p5.prototype.animation=function(anim,x,y){anim.draw(x,y)},defineLazyP5Property("_p5play",(function(){return{keyStates:{},mouseStates:{}}}));var KEY_IS_UP=0,KEY_WENT_DOWN=1,KEY_IS_DOWN=2,KEY_WENT_UP=3;function Sprite(pInst,_x,_y,_w,_h){var pInstBind=createPInstBinder(pInst),createVector=pInstBind("createVector"),color=pInstBind("color"),random=pInstBind("random"),print=pInstBind("print"),push=pInstBind("push"),pop=pInstBind("pop"),colorMode=pInstBind("colorMode"),noStroke=pInstBind("noStroke"),rectMode=pInstBind("rectMode"),ellipseMode=pInstBind("ellipseMode"),imageMode=pInstBind("imageMode"),translate=pInstBind("translate"),scale=pInstBind("scale"),rotate=pInstBind("rotate"),stroke=pInstBind("stroke"),strokeWeight=pInstBind("strokeWeight"),line=pInstBind("line"),noFill=pInstBind("noFill"),fill=pInstBind("fill"),textAlign=pInstBind("textAlign"),textSize=pInstBind("textSize"),text=pInstBind("text"),rect=pInstBind("rect"),cos=pInstBind("cos"),sin=pInstBind("sin"),atan2=pInstBind("atan2"),quadTree=pInst.quadTree,camera=pInst.camera,RGB=p5.prototype.RGB,CENTER=p5.prototype.CENTER,LEFT=p5.prototype.LEFT,BOTTOM=p5.prototype.BOTTOM;this.position=createVector(_x,_y),this.previousPosition=createVector(_x,_y),this.newPosition=createVector(_x,_y),this.deltaX=0,this.deltaY=0,this.velocity=createVector(0,0),this.maxSpeed=-1,this.friction=0,this.collider=void 0,this.colliderType="none",this.touching={},this.touching.left=!1,this.touching.right=!1,this.touching.top=!1,this.touching.bottom=!1,this.mass=1,this.immovable=!1,this.restitution=1,Object.defineProperty(this,"rotation",{enumerable:!0,get:function(){return this._rotation},set:function(value){this._rotation=value,this.rotateToDirection&&this.setSpeed(this.getSpeed(),value)}}),this._rotation=0,this.rotationSpeed=0,this.rotateToDirection=!1,this.depth=0,this.scale=1;var dirX=1,dirY=1;this.visible=!0,this.mouseActive=!1,this.mouseIsOver=!1,this.mouseIsPressed=!1,this._internalWidth=_w,this._internalHeight=_h,Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return this._internalWidth},set:function(value){this._internalWidth=value}}),this.width=void 0===_w?100:_w,Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return this._internalHeight},set:function(value){this._internalHeight=value}}),this.height=void 0===_h?100:_h,this.originalWidth=this._internalWidth,this.originalHeight=this._internalHeight,this.removed=!1,this.life=-1,this.debug=!1,this.shapeColor=color(random(255),random(255),random(255)),this.groups=[];var animations={},currentAnimation="";this.animation=void 0,this._drawnWithCamera=!1,this._syncAnimationSizes=function(){"default"===this.colliderType&&1!==animations[currentAnimation].getWidth()&&1!==animations[currentAnimation].getHeight()&&(this.collider=this.getBoundingBox(),this.colliderType="image",this._internalWidth=animations[currentAnimation].getWidth()*abs(this._getScaleX()),this._internalHeight=animations[currentAnimation].getHeight()*abs(this._getScaleY())),(animations[currentAnimation].frameChanged||void 0===this.width||void 0===this.height)&&(this._internalWidth=animations[currentAnimation].getWidth()*abs(this._getScaleX()),this._internalHeight=animations[currentAnimation].getHeight()*abs(this._getScaleY()))},this.update=function(){if(!this.removed){if(this.newPosition!==this.position?this.previousPosition=createVector(this.newPosition.x,this.newPosition.y):this.previousPosition=createVector(this.position.x,this.position.y),this.velocity.x*=1-this.friction,this.velocity.y*=1-this.friction,-1!==this.maxSpeed&&this.limitSpeed(this.maxSpeed),this.rotateToDirection&&this.velocity.mag()>0&&(this._rotation=this.getDirection()),this.rotation+=this.rotationSpeed,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.newPosition=createVector(this.position.x,this.position.y),this.deltaX=this.position.x-this.previousPosition.x,this.deltaY=this.position.y-this.previousPosition.y,animations[currentAnimation]&&(animations[currentAnimation].update(),this._syncAnimationSizes()),this.collider){var t;if(this.collider instanceof AABB)t=pInst._angleMode===pInst.RADIANS?radians(this.rotation):this.rotation,"custom"===this.colliderType?(this.collider.extents.x=this.collider.originalExtents.x*abs(this._getScaleX())*abs(cos(t))+this.collider.originalExtents.y*abs(this._getScaleY())*abs(sin(t)),this.collider.extents.y=this.collider.originalExtents.x*abs(this._getScaleX())*abs(sin(t))+this.collider.originalExtents.y*abs(this._getScaleY())*abs(cos(t))):"default"===this.colliderType?(this.collider.extents.x=this._internalWidth*abs(this._getScaleX())*abs(cos(t))+this._internalHeight*abs(this._getScaleY())*abs(sin(t)),this.collider.extents.y=this._internalWidth*abs(this._getScaleX())*abs(sin(t))+this._internalHeight*abs(this._getScaleY())*abs(cos(t))):"image"===this.colliderType&&(this.collider.extents.x=this._internalWidth*abs(cos(t))+this._internalHeight*abs(sin(t)),this.collider.extents.y=this._internalWidth*abs(sin(t))+this._internalHeight*abs(cos(t)));this.collider instanceof CircleCollider&&(this.collider.radius=this.collider.originalRadius*abs(this.scale))}this.mouseActive?(this.collider||this.setDefaultCollider(),this.mouseUpdate()):"function"!=typeof this.onMouseOver&&"function"!=typeof this.onMouseOut&&"function"!=typeof this.onMousePressed&&"function"!=typeof this.onMouseReleased||(this.mouseActive=!0,this.collider||this.setDefaultCollider(),this.mouseUpdate()),this.life>0&&this.life--,0===this.life&&this.remove()}},this.setDefaultCollider=function(){animations[currentAnimation]&&1!==animations[currentAnimation].getWidth()&&1!==animations[currentAnimation].getHeight()?(this.collider=this.getBoundingBox(),this._internalWidth=animations[currentAnimation].getWidth()*abs(this._getScaleX()),this._internalHeight=animations[currentAnimation].getHeight()*abs(this._getScaleY()),this.colliderType="image"):animations[currentAnimation]&&1===animations[currentAnimation].getWidth()&&1===animations[currentAnimation].getHeight()||(this.collider=new AABB(pInst,this.position,createVector(this._internalWidth,this._internalHeight)),this.colliderType="default"),pInst.quadTree.insert(this)},this.mouseUpdate=function(){var mouseWasOver=this.mouseIsOver,mouseWasPressed=this.mouseIsPressed,mousePosition;this.mouseIsOver=!1,this.mouseIsPressed=!1,mousePosition=this._drawnWithCamera?createVector(camera.mouseX,camera.mouseY):createVector(pInst.mouseX,pInst.mouseY),this.collider&&(this.collider instanceof CircleCollider?dist(mousePosition.x,mousePosition.y,this.collider.center.x,this.collider.center.y)<this.collider.radius&&(this.mouseIsOver=!0):this.collider instanceof AABB&&mousePosition.x>this.collider.left()&&mousePosition.y>this.collider.top()&&mousePosition.x<this.collider.right()&&mousePosition.y<this.collider.bottom()&&(this.mouseIsOver=!0),this.mouseIsOver&&pInst.mouseIsPressed&&(this.mouseIsPressed=!0),!mouseWasOver&&this.mouseIsOver&&void 0!==this.onMouseOver&&("function"==typeof this.onMouseOver?this.onMouseOver.call(this,this):print("Warning: onMouseOver should be a function")),mouseWasOver&&!this.mouseIsOver&&void 0!==this.onMouseOut&&("function"==typeof this.onMouseOut?this.onMouseOut.call(this,this):print("Warning: onMouseOut should be a function")),!mouseWasPressed&&this.mouseIsPressed&&void 0!==this.onMousePressed&&("function"==typeof this.onMousePressed?this.onMousePressed.call(this,this):print("Warning: onMousePressed should be a function")),!mouseWasPressed||pInst.mouseIsPressed||this.mouseIsPressed||void 0===this.onMouseReleased||("function"==typeof this.onMouseReleased?this.onMouseReleased.call(this,this):print("Warning: onMouseReleased should be a function")))},this.setCollider=function(type,offsetX,offsetY,width,height){if("rectangle"!==type&&"circle"!==type)throw new TypeError('setCollider expects the first argument to be either "circle" or "rectangle"');if("circle"===type&&arguments.length>1&&arguments.length<4)throw new TypeError('Usage: setCollider("circle") or setCollider("circle", offsetX, offsetY, radius)');if("circle"===type&&arguments.length>4)pInst._warn('Extra parameters to setCollider were ignored. Usage: setCollider("circle") or setCollider("circle", offsetX, offsetY, radius)');else{if("rectangle"===type&&arguments.length>1&&arguments.length<5)throw new TypeError('Usage: setCollider("rectangle") or setCollider("rectangle", offsetX, offsetY, width, height)');"rectangle"===type&&arguments.length>5&&pInst._warn('Extra parameters to setCollider were ignored. Usage: setCollider("rectangle") or setCollider("rectangle", offsetX, offsetY, width, height)')}this.colliderType="custom";var v=createVector(offsetX,offsetY);"rectangle"===type&&1===arguments.length?this.collider=new AABB(pInst,this.position,createVector(this.width,this.height)):"rectangle"===type&&arguments.length>=5?this.collider=new AABB(pInst,this.position,createVector(width,height),v):"circle"===type&&1===arguments.length?this.collider=new CircleCollider(pInst,this.position,Math.floor(Math.max(this.width,this.height)/2)):"circle"===type&&arguments.length>=4&&(this.collider=new CircleCollider(pInst,this.position,width,v)),quadTree.insert(this)},this.getBoundingBox=function(){var w=animations[currentAnimation].getWidth()*abs(this._getScaleX()),h=animations[currentAnimation].getHeight()*abs(this._getScaleY());return new AABB(pInst,this.position,createVector(w,h))},this.mirrorX=function(dir){if(1!==dir&&-1!==dir)return dirX;dirX=dir},this.mirrorY=function(dir){if(1!==dir&&-1!==dir)return dirY;dirY=dir},this._getScaleX=function(){return this.scale},this._getScaleY=function(){return this.scale},this.display=function(){this.visible&&!this.removed&&(push(),colorMode(RGB),noStroke(),rectMode(CENTER),ellipseMode(CENTER),imageMode(CENTER),translate(this.position.x,this.position.y),scale(this._getScaleX()*dirX,this._getScaleY()*dirY),pInst._angleMode===pInst.RADIANS?rotate(radians(this.rotation)):rotate(this.rotation),this.draw(),pop(),this._drawnWithCamera=camera.active,this.debug&&(push(),stroke(0,255,0),strokeWeight(1),line(this.position.x-10,this.position.y,this.position.x+10,this.position.y),line(this.position.x,this.position.y-10,this.position.x,this.position.y+10),noFill(),noStroke(),fill(0,255,0),textAlign(LEFT,BOTTOM),textSize(16),text(this.depth+"",this.position.x+4,this.position.y-2),noFill(),stroke(0,255,0),void 0!==this.collider&&this.collider.draw(),pop()))},this.draw=function(){""!==currentAnimation&&animations?animations[currentAnimation]&&animations[currentAnimation].draw(0,0,0):(noStroke(),fill(this.shapeColor),rect(0,0,this._internalWidth,this._internalHeight))},this.remove=function(){for(this.removed=!0,quadTree.removeObject(this);this.groups.length>0;)this.groups[0].remove(this)},this.setVelocity=function(x,y){this.velocity.x=x,this.velocity.y=y},this.getSpeed=function(){return this.velocity.mag()},this.getDirection=function(){var direction=atan2(this.velocity.y,this.velocity.x);return isNaN(direction)&&(direction=0),pInst._angleMode===pInst.RADIANS&&(direction=degrees(direction)),direction},this.addToGroup=function(group){group instanceof Array?group.add(this):print("addToGroup error: "+group+" is not a group")},this.limitSpeed=function(max){var speed=this.getSpeed();if(abs(speed)>max){var k=max/abs(speed);this.velocity.x*=k,this.velocity.y*=k}},this.setSpeed=function(speed,angle){var a;a=void 0===angle?0!==this.velocity.x||0!==this.velocity.y?pInst.atan2(this.velocity.y,this.velocity.x):pInst._angleMode===pInst.RADIANS?radians(this._rotation):this._rotation:pInst._angleMode===pInst.RADIANS?radians(angle):angle,this.velocity.x=cos(a)*speed,this.velocity.y=sin(a)*speed},this.addSpeed=function(speed,angle){var a;a=pInst._angleMode===pInst.RADIANS?radians(angle):angle,this.velocity.x+=cos(a)*speed,this.velocity.y+=sin(a)*speed},this.attractionPoint=function(magnitude,pointX,pointY){var angle=atan2(pointY-this.position.y,pointX-this.position.x);this.velocity.x+=cos(angle)*magnitude,this.velocity.y+=sin(angle)*magnitude},this.addImage=function(){if("string"==typeof arguments[0]&&arguments[1]instanceof p5.Image)this.addAnimation(arguments[0],arguments[1]);else{if(!(arguments[0]instanceof p5.Image))throw"addImage error: allowed usages are <image> or <label>, <image>";this.addAnimation("normal",arguments[0])}},this.addAnimation=function(label){var anim;if("string"!=typeof label)return print("Sprite.addAnimation error: the first argument must be a label (String)"),-1;if(arguments.length<2)return print("addAnimation error: you must specify a label and n frame images"),-1;if(arguments[1]instanceof Animation){var sourceAnimation=arguments[1],newAnimation=sourceAnimation.clone();return animations[label]=newAnimation,""===currentAnimation&&(currentAnimation=label,this.animation=newAnimation),newAnimation.isSpriteAnimation=!0,this._internalWidth=newAnimation.getWidth()*abs(this._getScaleX()),this._internalHeight=newAnimation.getHeight()*abs(this._getScaleY()),newAnimation}for(var animFrames=[],i=1;i<arguments.length;i++)animFrames.push(arguments[i]);return anim=construct(pInst.Animation,animFrames),animations[label]=anim,""===currentAnimation&&(currentAnimation=label,this.animation=anim),anim.isSpriteAnimation=!0,this._internalWidth=anim.getWidth()*abs(this._getScaleX()),this._internalHeight=anim.getHeight()*abs(this._getScaleY()),anim},this.changeImage=function(label){this.changeAnimation(label)},this.getAnimationLabel=function(){return currentAnimation},this.changeAnimation=function(label){animations[label]?(currentAnimation=label,this.animation=animations[label]):print("changeAnimation error: no animation labeled "+label)},this.overlapPixel=function(pointX,pointY){var point=createVector(pointX,pointY),img=this.animation.getFrameImage(),values;return point.x-=this.position.x-img.width/2,point.y-=this.position.y-img.height/2,!(point.x<0||point.x>img.width||point.y<0||point.y>img.height)&&(0===this.rotation&&1===this.scale?255===img.get(point.x,point.y)[3]:(print("Error: overlapPixel doesn't work with scaled or rotated sprites yet"),!1))},this.overlapPoint=function(pointX,pointY){var point=createVector(pointX,pointY);if(this.collider||this.setDefaultCollider(),void 0!==this.collider){if(this.collider instanceof AABB)return point.x>this.collider.left()&&point.x<this.collider.right()&&point.y>this.collider.top()&&point.y<this.collider.bottom();if(this.collider instanceof CircleCollider){var sqRadius=this.collider.radius*this.collider.radius,sqDist;return pow(this.collider.center.x-point.x,2)+pow(this.collider.center.y-point.y,2)<sqRadius}return!1}return!1},this.overlap=function(target,callback){return this.AABBops("overlap",target,callback)},this.collide=function(target,callback){return this.AABBops("collide",target,callback)},this.displace=function(target,callback){return this.AABBops("displace",target,callback)},this.bounce=function(target,callback){return this.AABBops("bounce",target,callback)},this.AABBops=function(type,target,callback){this.touching.left=!1,this.touching.right=!1,this.touching.top=!1,this.touching.bottom=!1;var result=!1,others=[];if(target instanceof Sprite)others.push(target);else{if(!(target instanceof Array))throw"Error: overlap can only be checked between sprites or groups";void 0!==quadTree&&quadTree.active&&(others=quadTree.retrieveFromGroup(this,target)),0===others.length&&(others=target)}for(var i=0;i<others.length;i++)if(this!==others[i]&&!this.removed){var displacement,other=others[i],over;if(void 0===this.collider&&this.setDefaultCollider(),void 0===other.collider&&other.setDefaultCollider(),void 0!==this.collider&&void 0!==other.collider)if("overlap"===type)(over=this.collider instanceof CircleCollider?other.collider.overlap(this.collider):this.collider.overlap(other.collider))&&(result=!0,void 0!==callback&&"function"==typeof callback&&callback.call(this,this,other));else if("collide"===type||"displace"===type||"bounce"===type){displacement=createVector(0,0);var tunnelX=abs(this.velocity.x-other.velocity.x)>=other.collider.extents.x/2&&0===round(this.deltaX-this.velocity.x),tunnelY=abs(this.velocity.y-other.velocity.y)>=other.collider.size().y/2&&0===round(this.deltaY-this.velocity.y);if(tunnelX||tunnelY){var c=createVector((this.position.x+this.previousPosition.x)/2,(this.position.y+this.previousPosition.y)/2),e=createVector(abs(this.position.x-this.previousPosition.x)+this.collider.extents.x,abs(this.position.y-this.previousPosition.y)+this.collider.extents.y),bbox;new AABB(pInst,c,e,this.collider.offset).overlap(other.collider)&&(tunnelX&&(this.velocity.x<0?displacement.x=other.collider.right()-this.collider.left()+1:this.velocity.x>0&&(displacement.x=other.collider.left()-this.collider.right()-1)),tunnelY&&(this.velocity.y>0?displacement.y=other.collider.top()-this.collider.bottom()-1:this.velocity.y<0&&(displacement.y=other.collider.bottom()-this.collider.top()+1)))}else displacement=this.collider instanceof CircleCollider?other.collider.collide(this.collider).mult(-1):this.collider.collide(other.collider);if(0!==displacement.x||0!==displacement.y){var newVelX1,newVelY1,newVelX2,newVelY2;if("displace"!==type||other.immovable?"collide"!==type&&"bounce"!==type||this.immovable||(this.position.add(displacement),this.previousPosition=createVector(this.position.x,this.position.y),this.newPosition=createVector(this.position.x,this.position.y)):other.position.sub(displacement),displacement.x>0&&(this.touching.left=!0),displacement.x<0&&(this.touching.right=!0),displacement.y<0&&(this.touching.bottom=!0),displacement.y>0&&(this.touching.top=!0),"bounce"===type)if(this.collider instanceof CircleCollider&&other.collider instanceof CircleCollider){var dx1=p5.Vector.sub(this.position,other.position),dx2=p5.Vector.sub(other.position,this.position),magnitude=dx1.magSq(),totalMass=this.mass+other.mass,m1=0,m2=0;this.immovable?m2=2:other.immovable?m1=2:(m1=2*other.mass/totalMass,m2=2*this.mass/totalMass);var newVel1=dx1.mult(m1*p5.Vector.sub(this.velocity,other.velocity).dot(dx1)/magnitude),newVel2=dx2.mult(m2*p5.Vector.sub(other.velocity,this.velocity).dot(dx2)/magnitude);this.velocity.sub(newVel1.mult(this.restitution)),other.velocity.sub(newVel2.mult(other.restitution))}else other.immovable?(newVelX1=-this.velocity.x+other.velocity.x,newVelY1=-this.velocity.y+other.velocity.y):(newVelX1=(this.velocity.x*(this.mass-other.mass)+2*other.mass*other.velocity.x)/(this.mass+other.mass),newVelY1=(this.velocity.y*(this.mass-other.mass)+2*other.mass*other.velocity.y)/(this.mass+other.mass),newVelX2=(other.velocity.x*(other.mass-this.mass)+2*this.mass*this.velocity.x)/(this.mass+other.mass),newVelY2=(other.velocity.y*(other.mass-this.mass)+2*this.mass*this.velocity.y)/(this.mass+other.mass)),abs(displacement.x)>abs(displacement.y)&&(this.immovable||(this.velocity.x=newVelX1*this.restitution),other.immovable||(other.velocity.x=newVelX2*other.restitution)),abs(displacement.x)<abs(displacement.y)&&(this.immovable||(this.velocity.y=newVelY1*this.restitution),other.immovable||(other.velocity.y=newVelY2*other.restitution));void 0!==callback&&"function"==typeof callback&&callback.call(this,this,other),result=!0}}}return result}}function Camera(pInst,x,y,zoom){this.position=pInst.createVector(x,y),this.zoom=zoom,this.mouseX=pInst.mouseX,this.mouseY=pInst.mouseY,this.active=!1,this.on=function(){this.active||(cameraPush.call(pInst),this.active=!0)},this.off=function(){this.active&&(cameraPop.call(pInst),this.active=!1)}}function cameraPush(){var pInst=this,camera=this.camera;camera.init||0!==camera.position.x||0!==camera.position.y||(camera.position.x=this.width/2,camera.position.y=this.height/2,camera.init=!0),camera.mouseX=this.mouseX+camera.position.x-this.width/2,camera.mouseY=this.mouseY+camera.position.y-this.height/2,camera.active||(camera.active=!0,this.push(),this.scale(camera.zoom),this.translate(-camera.position.x+this.width/2/camera.zoom,-camera.position.y+this.height/2/camera.zoom))}function cameraPop(){var pInst=this;this.camera.active&&(this.pop(),this.camera.active=!1)}function Group(){var array=[];function virtEquals(obj,other){return null===obj||null===other?null===obj&&null===other:"string"==typeof obj?obj===other:"object"!=typeof obj?obj===other:obj.equals instanceof Function?obj.equals(other):obj===other}function _groupCollide(type,target,callback){for(var didCollide=!1,i=0;i<this.size();i++)didCollide=this.get(i).AABBops(type,target,callback)||didCollide;return didCollide}return array.get=function(i){return array[i]},array.contains=function(sprite){return this.indexOf(sprite)>-1},array.indexOf=function(item){for(var i=0,len=array.length;i<len;++i)if(virtEquals(item,array[i]))return i;return-1},array.add=function(s){if(!(s instanceof Sprite))throw"Error: you can only add sprites to a group";-1===this.indexOf(s)&&(array.push(s),s.groups.push(this))},array.size=function(){return array.length},array.removeSprites=function(){for(;array.length>0;)array[0].remove()},array.clear=function(){array.length=0},array.remove=function(item){if(!(item instanceof Sprite))throw"Error: you can only remove sprites from a group";var i,removed=!1;for(i=array.length-1;i>=0;i--)array[i]===item&&(array.splice(i,1),removed=!0);if(removed)for(i=item.groups.length-1;i>=0;i--)item.groups[i]===this&&item.groups.splice(i,1);return removed},array.toArray=function(){return array.slice(0)},array.maxDepth=function(){return 0===array.length?0:array.reduce((function(maxDepth,sprite){return Math.max(maxDepth,sprite.depth)}),-1/0)},array.minDepth=function(){return 0===array.length?99999:array.reduce((function(minDepth,sprite){return Math.min(minDepth,sprite.depth)}),1/0)},array.draw=function(){this.sort((function(a,b){return a.depth-b.depth}));for(var i=0;i<this.size();i++)this.get(i).display()},array.overlap=_groupCollide.bind(array,"overlap"),array.collide=_groupCollide.bind(array,"collide"),array.displace=_groupCollide.bind(array,"displace"),array.bounce=_groupCollide.bind(array,"bounce"),array}function CircleCollider(pInst,_center,_radius,_offset){var pInstBind,createVector=createPInstBinder(pInst)("createVector"),CENTER=p5.prototype.CENTER;this.center=_center,this.radius=_radius,this.originalRadius=_radius,this.offset=void 0===_offset?createVector(0,0):_offset,this.extents=createVector(2*_radius,2*_radius),this.draw=function(){pInst.noFill(),pInst.stroke(0,255,0),pInst.rectMode(CENTER),pInst.ellipse(this.center.x+this.offset.x,this.center.y+this.offset.y,2*this.radius,2*this.radius)},this.overlap=function(other){var r=this.radius+other.radius;r*=r;var thisCenterX=this.center.x+this.offset.x,thisCenterY=this.center.y+this.offset.y,otherCenterX=other.center.x+other.offset.x,otherCenterY=other.center.y+other.offset.y,sqDist;return r>pow(thisCenterX-otherCenterX,2)+pow(thisCenterY-otherCenterY,2)},this.collide=function(other){if(this.overlap(other)){var thisCenterX=this.center.x+this.offset.x,thisCenterY=this.center.y+this.offset.y,otherCenterX=other.center.x+other.offset.x,otherCenterY=other.center.y+other.offset.y,a=pInst.atan2(thisCenterY-otherCenterY,thisCenterX-otherCenterX),radii=this.radius+other.radius,intersection=abs(radii-dist(thisCenterX,thisCenterY,otherCenterX,otherCenterY)),displacement;return createVector(pInst.cos(a)*intersection,pInst.sin(a)*intersection)}return createVector(0,0)},this.size=function(){return createVector(2*this.radius,2*this.radius)},this.left=function(){return this.center.x+this.offset.x-this.radius},this.right=function(){return this.center.x+this.offset.x+this.radius},this.top=function(){return this.center.y+this.offset.y-this.radius},this.bottom=function(){return this.center.y+this.offset.y+this.radius}}function AABB(pInst,_center,_extents,_offset){var pInstBind,createVector=createPInstBinder(pInst)("createVector"),CENTER=p5.prototype.CENTER,PI=p5.prototype.PI;this.center=_center,this.extents=_extents,this.originalExtents=_extents.copy(),this.offset=void 0===_offset?createVector(0,0):_offset,this.min=function(){return createVector(this.center.x+this.offset.x-this.extents.x,this.center.y+this.offset.y-this.extents.y)},this.max=function(){return createVector(this.center.x+this.offset.x+this.extents.x,this.center.y+this.offset.y+this.extents.y)},this.right=function(){return this.center.x+this.offset.x+this.extents.x/2},this.left=function(){return this.center.x+this.offset.x-this.extents.x/2},this.top=function(){return this.center.y+this.offset.y-this.extents.y/2},this.bottom=function(){return this.center.y+this.offset.y+this.extents.y/2},this.size=function(){return createVector(2*this.extents.x,2*this.extents.y)},this.rotate=function(r){var t;t=pInst._angleMode===pInst.RADIANS?radians(r):r;var w2=this.extents.x*abs(pInst.cos(t))+this.extents.y*abs(pInst.sin(t)),h2=this.extents.x*abs(pInst.sin(t))+this.extents.y*abs(pInst.cos(t));this.extents.x=w2,this.extents.y=h2},this.draw=function(){pInst.noFill(),pInst.stroke(0,255,0),pInst.rectMode(CENTER),pInst.rect(this.center.x+this.offset.x,this.center.y+this.offset.y,this.size().x/2,this.size().y/2)},this.overlap=function(other){if(other instanceof AABB){var md=other.minkowskiDifference(this);return md.min().x<=0&&md.max().x>=0&&md.min().y<=0&&md.max().y>=0}if(other instanceof CircleCollider){var pt=createVector(other.center.x,other.center.y),distance;return other.center.x<this.left()?pt.x=this.left():other.center.x>this.right()&&(pt.x=this.right()),other.center.y<this.top()?pt.y=this.top():other.center.y>this.bottom()&&(pt.y=this.bottom()),pt.dist(other.center)<other.radius}},this.collide=function(other){if(other instanceof AABB){var md=other.minkowskiDifference(this),boundsPoint;return md.min().x<=0&&md.max().x>=0&&md.min().y<=0&&md.max().y>=0?md.closestPointOnBoundsToPoint(createVector(0,0)):createVector(0,0)}if(other instanceof CircleCollider){var pt=createVector(other.center.x,other.center.y),distance,a;if(other.center.x<this.left()?pt.x=this.left():other.center.x>this.right()&&(pt.x=this.right()),other.center.y<this.top()?pt.y=this.top():other.center.y>this.bottom()&&(pt.y=this.bottom()),pt.dist(other.center)<other.radius){if(pt.x===other.center.x&&pt.y===other.center.y){var xOverlap=pt.x-this.center.x,yOverlap=pt.y-this.center.y;abs(xOverlap)<abs(yOverlap)?pt.x=xOverlap>0?this.right():this.left():pt.y=yOverlap<0?this.top():this.bottom(),0===(a=pInst.atan2(other.center.y-pt.y,other.center.x-pt.x))&&(pt.x===this.right()&&(a=PI),pt.y===this.top()&&(a=PI/2),pt.y===this.bottom()&&(a=-PI/2))}else a=pInst.atan2(pt.y-other.center.y,pt.x-other.center.x);var d=createVector(pt.x-other.center.x,pt.y-other.center.y),displacement;return createVector(pInst.cos(a)*other.radius-d.x,pInst.sin(a)*other.radius-d.y)}return createVector(0,0)}},this.minkowskiDifference=function(other){var topLeft=this.min().sub(other.max()),fullSize=this.size().add(other.size());return new AABB(pInst,topLeft.add(fullSize.div(2)),fullSize.div(2))},this.closestPointOnBoundsToPoint=function(point){var minDist=abs(point.x-this.min().x),boundsPoint=createVector(this.min().x,point.y);return abs(this.max().x-point.x)<minDist&&(minDist=abs(this.max().x-point.x),boundsPoint=createVector(this.max().x,point.y)),abs(this.max().y-point.y)<minDist&&(minDist=abs(this.max().y-point.y),boundsPoint=createVector(point.x,this.max().y)),abs(this.min().y-point.y)<minDist&&(minDist=abs(this.min.y-point.y),boundsPoint=createVector(point.x,this.min().y)),boundsPoint}}function Animation(pInst){var frameArguments=Array.prototype.slice.call(arguments,1),i,CENTER=p5.prototype.CENTER;this.images=[];var frame=0,cycles=0,targetFrame=-1;if(this.offX=0,this.offY=0,this.frameDelay=4,this.playing=!0,this.visible=!0,this.looping=!0,this.frameChanged=!1,this.imageCollider=!1,2===frameArguments.length&&"string"==typeof frameArguments[0]&&"string"==typeof frameArguments[1]){var from=frameArguments[0],to=frameArguments[1],ext1=from.substring(from.length-4,from.length);".png"!==ext1&&(pInst.print("Animation error: you need to use .png files (filename "+from+")"),from=-1);var ext2=to.substring(to.length-4,to.length);if(".png"!==ext2&&(pInst.print("Animation error: you need to use .png files (filename "+to+")"),to=-1),-1!==from&&-1!==to){var digits1=0,digits2=0;for(i=from.length-5;i>=0;i--)from.charAt(i)>="0"&&from.charAt(i)<="9"&&digits1++;for(i=to.length-5;i>=0;i--)to.charAt(i)>="0"&&to.charAt(i)<="9"&&digits2++;var prefix1=from.substring(0,from.length-(4+digits1)),prefix2=to.substring(0,to.length-(4+digits2)),number1=parseInt(from.substring(from.length-(4+digits1),from.length-4),10),number2=parseInt(to.substring(to.length-(4+digits2),to.length-4),10),fileName;if(number2<number1){var t=number2;number2=number1,number1=t}if(prefix1!==prefix2)this.images.push(pInst.loadImage(from)),this.images.push(pInst.loadImage(to));else if(digits1===digits2)for(i=number1;i<=number2;i++)fileName=prefix1+pInst.nf(i,digits1)+".png",this.images.push(pInst.loadImage(fileName));else for(i=number1;i<=number2;i++)fileName=prefix1+i+".png",this.images.push(pInst.loadImage(fileName))}}else if(1===frameArguments.length&&frameArguments[0]instanceof SpriteSheet)this.spriteSheet=frameArguments[0],this.images=this.spriteSheet.frames;else if(0!==frameArguments.length)for(i=0;i<frameArguments.length;i++)frameArguments[i]instanceof p5.Image?this.images.push(frameArguments[i]):this.images.push(pInst.loadImage(frameArguments[i]));this.clone=function(){var myClone=new Animation(pInst);return myClone.images=[],this.spriteSheet&&(myClone.spriteSheet=this.spriteSheet.clone()),myClone.images=this.images.slice(),myClone.offX=this.offX,myClone.offY=this.offY,myClone.frameDelay=this.frameDelay,myClone.playing=this.playing,myClone.looping=this.looping,myClone},this.draw=function(x,y,r){if(this.xpos=x,this.ypos=y,this.rotation=r||0,this.visible){if(this.isSpriteAnimation||this.update(),pInst.push(),pInst.imageMode(CENTER),pInst.translate(this.xpos,this.ypos),pInst._angleMode===pInst.RADIANS?pInst.rotate(radians(this.rotation)):pInst.rotate(this.rotation),void 0!==this.images[frame])if(this.spriteSheet){var frame_info=this.images[frame].frame;pInst.image(this.spriteSheet.image,this.offX,this.offY,frame_info.width,frame_info.height,frame_info.x,frame_info.y,frame_info.width,frame_info.height)}else pInst.image(this.images[frame],this.offX,this.offY);else pInst.print("Warning undefined frame "+frame);pInst.pop()}},this.update=function(){cycles++;var previousFrame=frame;this.frameChanged=!1,1===this.images.length&&(this.playing=!1,frame=0),this.playing&&cycles%this.frameDelay==0&&(targetFrame>frame&&-1!==targetFrame?frame++:targetFrame<frame&&-1!==targetFrame?frame--:targetFrame===frame&&-1!==targetFrame?this.playing=!1:this.looping?frame>=this.images.length-1?frame=0:frame++:frame<this.images.length-1&&frame++),frame==this.images.length-1&&null!=this.onComplete&&this.onComplete(),previousFrame!==frame&&(this.frameChanged=!0)},this.play=function(){this.playing=!0,targetFrame=-1},this.stop=function(){this.playing=!1},this.rewind=function(){frame=0},this.onComplete=function(){},this.changeFrame=function(f){frame=f<this.images.length?f:this.images.length-1,targetFrame=-1},this.nextFrame=function(){frame<this.images.length-1?frame+=1:this.looping&&(frame=0),targetFrame=-1,this.playing=!1},this.previousFrame=function(){frame>0?frame-=1:this.looping&&(frame=this.images.length-1),targetFrame=-1,this.playing=!1},this.goToFrame=function(toFrame){toFrame<0||toFrame>=this.images.length||(targetFrame=toFrame)!==frame&&(this.playing=!0)},this.getFrame=function(){return frame},this.getLastFrame=function(){return this.images.length-1},this.getFrameImage=function(){return this.images[frame]},this.getImageAt=function(f){return this.images[f]},this.getWidth=function(){return this.images[frame]instanceof p5.Image?this.images[frame].width:this.images[frame]?this.images[frame].frame.width:1},this.getHeight=function(){return this.images[frame]instanceof p5.Image?this.images[frame].height:this.images[frame]?this.images[frame].frame.height:1}}function SpriteSheet(pInst){var spriteSheetArgs=Array.prototype.slice.call(arguments,1);this.image=null,this.frames=[],this.frame_width=0,this.frame_height=0,this.num_frames=0,this._generateSheetFrames=function(){for(var sX=0,sY=0,i=0;i<this.num_frames;i++)this.frames.push({name:i,frame:{x:sX,y:sY,width:this.frame_width,height:this.frame_height}}),(sX+=this.frame_width)>=this.image.width&&(sX=0,(sY+=this.frame_height)>=this.image.height&&(sY=0))},2===spriteSheetArgs.length&&Array.isArray(spriteSheetArgs[1])?(this.frames=spriteSheetArgs[1],this.num_frames=this.frames.length):4===spriteSheetArgs.length&&"number"==typeof spriteSheetArgs[1]&&"number"==typeof spriteSheetArgs[2]&&"number"==typeof spriteSheetArgs[3]&&(this.frame_width=spriteSheetArgs[1],this.frame_height=spriteSheetArgs[2],this.num_frames=spriteSheetArgs[3]),spriteSheetArgs[0]instanceof p5.Image?(this.image=spriteSheetArgs[0],4===spriteSheetArgs.length&&this._generateSheetFrames()):2===spriteSheetArgs.length?this.image=pInst.loadImage(spriteSheetArgs[0]):4===spriteSheetArgs.length&&(this.image=pInst.loadImage(spriteSheetArgs[0],this._generateSheetFrames.bind(this))),this.drawFrame=function(frame_name,x,y,width,height){var frameToDraw;if("number"==typeof frame_name)frameToDraw=this.frames[frame_name].frame;else for(var i=0;i<this.frames.length;i++)if(this.frames[i].name===frame_name){frameToDraw=this.frames[i].frame;break}var dWidth=width||frameToDraw.width,dHeight=height||frameToDraw.height;pInst.image(this.image,frameToDraw.x,frameToDraw.y,frameToDraw.width,frameToDraw.height,x,y,dWidth,dHeight)},this.clone=function(){for(var myClone=new SpriteSheet(pInst),i=0;i<this.frames.length;i++){var frame=this.frames[i].frame,cloneFrame={name:frame.name,frame:{x:frame.x,y:frame.y,width:frame.width,height:frame.height}};myClone.frames.push(cloneFrame)}return myClone.image=this.image,myClone.frame_width=this.frame_width,myClone.frame_height=this.frame_height,myClone.num_frames=this.num_frames,myClone}}function construct(constructor,args){function F(){return constructor.apply(this,args)}return F.prototype=constructor.prototype,new F}function Quadtree(bounds,max_objects,max_levels,level){this.active=!0,this.max_objects=max_objects||10,this.max_levels=max_levels||4,this.level=level||0,this.bounds=bounds,this.objects=[],this.object_refs=[],this.nodes=[]}function updateTree(){this.quadTree.active&&(this.quadTree.updateBounds(),this.quadTree.cleanup())}p5.prototype.keyWentDown=function(key){return this._isKeyInState(key,1)},p5.prototype.keyWentUp=function(key){return this._isKeyInState(key,3)},p5.prototype.keyDown=function(key){return this._isKeyInState(key,2)},p5.prototype._isKeyInState=function(key,state){var keyCode,keyStates=this._p5play.keyStates;return void 0===keyStates[keyCode="string"==typeof key?this._keyCodeFromAlias(key):key]&&(this.keyIsDown(keyCode)?keyStates[keyCode]=2:keyStates[keyCode]=0),keyStates[keyCode]===state},p5.prototype.mouseDown=function(buttonCode){return this._isMouseButtonInState(buttonCode,2)},p5.prototype.mouseUp=function(buttonCode){return this._isMouseButtonInState(buttonCode,0)},p5.prototype.mouseWentUp=function(buttonCode){return this._isMouseButtonInState(buttonCode,3)},p5.prototype.mouseWentDown=function(buttonCode){return this._isMouseButtonInState(buttonCode,1)},p5.prototype._isMouseButtonInState=function(buttonCode,state){var mouseStates=this._p5play.mouseStates;return void 0===buttonCode&&(buttonCode=this.LEFT),void 0===mouseStates[buttonCode]&&(this.mouseIsPressed&&this.mouseButton===buttonCode?mouseStates[buttonCode]=2:mouseStates[buttonCode]=0),mouseStates[buttonCode]===state},p5.prototype.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32," ":32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,LEFT:37,UP_ARROW:38,UP:38,RIGHT_ARROW:39,RIGHT:39,DOWN_ARROW:40,DOWN:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"0NUMPAD":96,"1NUMPAD":97,"2NUMPAD":98,"3NUMPAD":99,"4NUMPAD":100,"5NUMPAD":101,"6NUMPAD":102,"7NUMPAD":103,"8NUMPAD":104,"9NUMPAD":105,MULTIPLY:106,PLUS:107,MINUS:109,DOT:110,SLASH1:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,EQUAL:187,COMMA:188,SLASH:191,BACKSLASH:220},p5.prototype.KEY_DEPRECATIONS={MINUT:"MINUS",COMA:"COMMA"},p5.prototype._keyCodeFromAlias=function(alias){return alias=alias.toUpperCase(),this.KEY_DEPRECATIONS[alias]&&(this._warn('Key literal "'+alias+'" is deprecated and may be removed in a future version of p5.play. Please use "'+this.KEY_DEPRECATIONS[alias]+'" instead.'),alias=this.KEY_DEPRECATIONS[alias]),this.KEY[alias]},p5.prototype.readPresses=function(){var keyStates=this._p5play.keyStates,mouseStates=this._p5play.mouseStates;for(var key in keyStates)this.keyIsDown(key)?0===keyStates[key]?keyStates[key]=1:keyStates[key]=2:2===keyStates[key]?keyStates[key]=3:keyStates[key]=0;for(var btn in mouseStates)this.mouseIsPressed&&this.mouseButton===btn?0===mouseStates[btn]?mouseStates[btn]=1:mouseStates[btn]=2:2===mouseStates[btn]?mouseStates[btn]=3:mouseStates[btn]=0},p5.prototype.useQuadTree=function(use){return void 0!==this.quadTree&&(void 0===use?this.quadTree.active:void(this.quadTree.active=!!use))},defineLazyP5Property("quadTree",(function(){return new Quadtree({x:0,y:0,width:0,height:0},4)})),defineLazyP5Property("Sprite",boundConstructorFactory(Sprite)),defineLazyP5Property("Camera",boundConstructorFactory(Camera)),p5.prototype.Group=Group,defineLazyP5Property("CircleCollider",boundConstructorFactory(CircleCollider)),defineLazyP5Property("AABB",boundConstructorFactory(AABB)),defineLazyP5Property("Animation",boundConstructorFactory(Animation)),defineLazyP5Property("SpriteSheet",boundConstructorFactory(SpriteSheet)),Quadtree.prototype.updateBounds=function(){for(var objects=this.getAll(),x=1e4,y=1e4,w=-1e4,h=-1e4,i=0;i<objects.length;i++)objects[i].position.x<x&&(x=objects[i].position.x),objects[i].position.y<y&&(y=objects[i].position.y),objects[i].position.x>w&&(w=objects[i].position.x),objects[i].position.y>h&&(h=objects[i].position.y);this.bounds={x:x,y:y,width:w,height:h}},Quadtree.prototype.split=function(){var nextLevel=this.level+1,subWidth=Math.round(this.bounds.width/2),subHeight=Math.round(this.bounds.height/2),x=Math.round(this.bounds.x),y=Math.round(this.bounds.y);this.nodes[0]=new Quadtree({x:x+subWidth,y:y,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel),this.nodes[1]=new Quadtree({x:x,y:y,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel),this.nodes[2]=new Quadtree({x:x,y:y+subHeight,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel),this.nodes[3]=new Quadtree({x:x+subWidth,y:y+subHeight,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel)},Quadtree.prototype.getIndex=function(pRect){if(pRect.collider){var index=-1,verticalMidpoint=this.bounds.x+this.bounds.width/2,horizontalMidpoint=this.bounds.y+this.bounds.height/2,topQuadrant=pRect.collider.top()<horizontalMidpoint&&pRect.collider.top()+pRect.collider.size().y<horizontalMidpoint,bottomQuadrant=pRect.collider.top()>horizontalMidpoint;return pRect.collider.left()<verticalMidpoint&&pRect.collider.left()+pRect.collider.size().x<verticalMidpoint?topQuadrant?index=1:bottomQuadrant&&(index=2):pRect.collider.left()>verticalMidpoint&&(topQuadrant?index=0:bottomQuadrant&&(index=3)),index}return-1},Quadtree.prototype.insert=function(obj){if(-1===this.objects.indexOf(obj)){var i=0,index;if(void 0!==this.nodes[0]&&-1!==(index=this.getIndex(obj)))return void this.nodes[index].insert(obj);if(this.objects.push(obj),this.objects.length>this.max_objects&&this.level<this.max_levels)for(void 0===this.nodes[0]&&this.split();i<this.objects.length;)-1!==(index=this.getIndex(this.objects[i]))?this.nodes[index].insert(this.objects.splice(i,1)[0]):i+=1}},Quadtree.prototype.retrieve=function(pRect){var index=this.getIndex(pRect),returnObjects=this.objects;if(void 0!==this.nodes[0])if(-1!==index)returnObjects=returnObjects.concat(this.nodes[index].retrieve(pRect));else for(var i=0;i<this.nodes.length;i+=1)returnObjects=returnObjects.concat(this.nodes[i].retrieve(pRect));return returnObjects},Quadtree.prototype.retrieveFromGroup=function(pRect,group){for(var results=[],candidates=this.retrieve(pRect),i=0;i<candidates.length;i++)group.contains(candidates[i])&&results.push(candidates[i]);return results},Quadtree.prototype.getAll=function(){for(var objects=this.objects,i=0;i<this.nodes.length;i+=1)objects=objects.concat(this.nodes[i].getAll());return objects},Quadtree.prototype.getObjectNode=function(obj){var index;if(!this.nodes.length)return this;if(-1===(index=this.getIndex(obj)))return this;var node=this.nodes[index].getObjectNode(obj);return node||!1},Quadtree.prototype.removeObject=function(obj){var node=this.getObjectNode(obj),index=node.objects.indexOf(obj);if(-1===index)return!1;node.objects.splice(index,1)},Quadtree.prototype.clear=function(){if(this.objects=[],this.nodes.length){for(var i=0;i<this.nodes.length;i+=1)this.nodes[i].clear();this.nodes=[]}},Quadtree.prototype.cleanup=function(){var objects=this.getAll();this.clear();for(var i=0;i<objects.length;i++)this.insert(objects[i])},p5.prototype.registerMethod("pre",p5.prototype.readPresses),p5.prototype.registerMethod("pre",p5.prototype.updateSprites),p5.prototype.registerMethod("post",updateTree),p5.prototype.registerMethod("pre",cameraPush),p5.prototype.registerMethod("post",cameraPop),p5.prototype._warn=function(message){var console=window.console;console&&("function"==typeof console.warn?console.warn(message):"function"==typeof console.log&&console.log("Warning: "+message))}}));